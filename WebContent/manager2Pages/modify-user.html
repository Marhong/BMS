<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6 lt8"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7 lt8"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8 lt8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<!-- <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">  -->
<title>Login and Registration Form with HTML5 and CSS3</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description"
	content="Login and Registration Form with HTML5 and CSS3" />
<meta name="keywords"
	content="html5, css3, form, switch, animation, :target, pseudo-class" />
<meta name="author" content="Codrops" />
<link rel="shortcut icon" href="../../favicon.ico">
<link rel="stylesheet" type="text/css" href="../css/demo.css" />
<link rel="stylesheet" type="text/css" href="../css/style.css" />
<link rel="stylesheet" type="text/css" href="../css/animate-custom.css" />
<style>
input[type="number"] {
	-moz-appearance: textfield;
}

input::-webkit-outer-spin-button, input::-webkit-inner-spin-button {
	-webkit-appearance: none !important;
	margin: 0;
}
</style>
</head>
<body onload="showUserInformation()">
	<div class="container">

		<div class="codrops-top"></div>
		<header>
			<h1>
				
			</h1>
			<nav class="codrops-demos"></nav>
		</header>
	
		<section>
			<div id="container_demo">
				<a class="hiddenanchor" id="toregister"></a> <a class="hiddenanchor"
					id="tologin"></a>
				<div id="wrapper">

					<div id="register" class="animate form">
						                            <form  action="http://localhost:8088/NWPU/manager2Pages/reader-information.html" autocomplete="on" onsubmit="return signUpCheck()" method="post"> 
                                <h1> Modify User Information </h1> 
							<p>
								<label for="id" class="uname" data-icon="u"> School Work Number </label> <input id="id" name="usernamesignup" readOnly="readOnly"
									disabled="disabled" type="number" title="" />
							</p>
							<p>
								<label for="userName" class="youpasswd" data-icon="p">
									User Name </label> <input id="userName" name="passwordsignup" required
									oninvalid="setCustomValidity('please input your password')"
									oninput="setCustomValidity('')" type="text"
									placeholder="user name" title="" />
							</p>
                                <p> 
                                    <label for="email" class="youmail" data-icon="e" > Eamil</label>
                                    <input id="email" name="eamil" required="required" type="email" placeholder="mysupermail@mail.com" title=""/> 
                                </p>

							<p>
								<label for="classNumber" class="uname" data-icon="u"> Class Number</label> <input id="classNumber" name="classNumber"
									required
									oninvalid="setCustomValidity('please input your school work number')"
									oninput="setCustomValidity('')"
									onchange="setCustomValidity('')"
									placeholder="class number" type="number" title="" />
							</p>
								<p>
								<label for="borrow_books" class="uname" data-icon="u"> Borrow Books</label> <input id="borrow_books" name="borrow_books"
									disabled="disabled" type="number" title="" />
							</p>
							<p>
								<label for="type" class="uname" data-icon="u"> User Type</label> <select id="type">
								<option >1</option>
								<option>2</option>
								<option>3</option>
								
								</select>
							</p>
							<p id="signUpError" class="keeplogin"
								style="color: red; display: none">the confirmed password is not equal to the password
								</p>
                                <p class="signin button"> 
									<input type="submit" value="Save" /> 
								</p>
                                <p class="change_link">  
								
									<a href="#" class="to_register" onclick="back()">Cancel </a>
								</p>
                            </form>
					</div>

				</div>
			</div>
		</section>
	</div>
</body>
<script>
function set_select_checked(selectId, checkValue){  
    var select = document.getElementById(selectId);  

    for (var i = 0; i < select.options.length; i++){  
        if (select.options[i].value == checkValue){  
            select.options[i].selected = true;  
            break;  
        }  
    }  
}
function showUserInformation(){
//	var state = getCookie("state");
	var id = getCookie("id");
	var userName = getCookie("userName");
	var email = getCookie("email");
	var classNumber = getCookie("classNumber");
 	var borrow_books = getCookie("borrow_books");
 	var type = getCookie("usertype");
	document.getElementById("id").value = id;
	document.getElementById("userName").value = userName;
	document.getElementById("email").value = email;
	document.getElementById("classNumber").value = classNumber;
	document.getElementById("borrow_books").value = borrow_books;
	set_select_checked("type",type);

	clearCookie("id");
	clearCookie("userName");
	clearCookie("email");
	clearCookie("classNumber");
	clearCookie("borrow_books");
	clearCookie("usertype");
}
//清除cookie    
function clearCookie(name) {    
    setCookie(name, "", -1);    
}
function getCookie(cname)
{
    var ss = document.cookie;
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i=0; i<ca.length; i++)
    {
        var c = ca[i].trim();
        if (c.indexOf(name)==0)
            return c.substring(name.length,c.length);
    }
    return "";
}
function back(){
	document.cookie = "state=1";
	window.location.href="reader-information.html"
	
}
function loadXMLDoc()
{
	
var xmlhttp,userName,password,result=false;
errorPrompt = document.getElementById("loginError");
userName=document.getElementById("username").value;
password=document.getElementById("password").value;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {	
	  if(xmlhttp.responseText=="correct"){
		  errorPrompt.style.display = "none";
		  result = true;
	  }else{
		  errorPrompt.style.display = "block";
		 
	  }
    
    }
  }
xmlhttp.open("POST","http://localhost:8088/NWPU/loginServlet",false);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
//xmlhttp.send("fname=Bill&lname=Gates");
xmlhttp.send("userName="+userName+"&password="+password);
return result;
}
	function signUpCheck(){
		var id,email,userName,classNumber,signUpError,xmlhttp,result=false;
		id = document.getElementById("id").value;
		email = document.getElementById("email").value;
		userName = document.getElementById("userName").value;
		classNumber = document.getElementById("classNumber").value;
		signUpError = document.getElementById("signUpError");
		type = document.getElementById("type").value;
		if (window.XMLHttpRequest)
		  {// code for IE7+, Firefox, Chrome, Opera, Safari
		  xmlhttp=new XMLHttpRequest();
		  }
		else
		  {// code for IE6, IE5
		  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
		  }
		xmlhttp.onreadystatechange=function()
		  {
		  if (xmlhttp.readyState==4 && xmlhttp.status==200)
		    {
			//	alert(xmlhttp.responseText);
 			  if(xmlhttp.responseText == "success"){
				//  errorPrompt.style.display = "none";
 				 // window.location.href="http://localhost:8088/NWPU/loginPages/notify.html"; 
 				 alert("Modify Successfully");
 				document.cookie = "state=1";
 				//window.location.href="http://localhost:8088/NWPU/manager2Pages/reader-information.html"; 
 				  result = true;
 			  }
		    
		    }
		  }
			xmlhttp.open("POST","http://localhost:8088/NWPU/updateUserServlet",false);
			xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			xmlhttp.send("userName="+userName+"&id="+id+"&email="+email+"&classNumber="+classNumber+"&type="+type);
			return result;
		


	}
	
	var user=document.getElementById("emailsignup");
	    user.onblur=function(){
	        if(user.value){
	            user.setCustomValidity("");//现将有输入时的提示设置为空
	        }else if(user.validity.valueMissing){
	            user.setCustomValidity("please input your email");  
	        };
	        if(user.validity.typeMismatch){ 
	            user.setCustomValidity("please input your email");
	        }
	    };
	
</script>
</html>